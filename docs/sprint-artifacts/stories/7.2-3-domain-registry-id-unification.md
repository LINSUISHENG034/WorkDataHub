# Story 7.2.3: Domain Registry ID Unification

Status: done

## Story

As a **Senior Python Architect**,
I want **to unify primary key naming across Domain Registry definitions and DDL scripts**,
so that **all domain tables consistently use `id` as the auto-increment primary key field**.

## Acceptance Criteria

1. ✅ `definitions/annuity_plans.py` uses `primary_key="id"`
2. ✅ `definitions/portfolio_plans.py` uses `primary_key="id"`
3. ✅ `scripts/create_table/ddl/annuity_plans.sql` uses `id` column
4. ✅ `scripts/create_table/ddl/portfolio_plans.sql` uses `id` column
5. ✅ `ddl_generator.generate_create_table_sql()` output verified

## Tasks / Subtasks

- [x] Task 1: Modify Domain Registry definitions
  - [x] Subtask 1.1: Update `definitions/annuity_plans.py` - primary_key → id
  - [x] Subtask 1.2: Update `definitions/portfolio_plans.py` - primary_key → id

- [x] Task 2: Modify DDL scripts
  - [x] Subtask 2.1: Update `scripts/create_table/ddl/annuity_plans.sql` - annuity_plans_id → id
  - [x] Subtask 2.2: Update `scripts/create_table/ddl/portfolio_plans.sql` - portfolio_plans_id → id

- [x] Task 3: Verification
  - [x] Subtask 3.1: Run `ddl_generator.generate_create_table_sql("annuity_plans")` - verify `id` output
  - [x] Subtask 3.2: Run `ddl_generator.generate_create_table_sql("portfolio_plans")` - verify `id` output

## Dev Notes

### Context from Validation

**Issue Discovered**: Story 7.2-2 validation revealed that `ddl_generator` would output `annuity_plans_id` instead of `id` if executed before this story.

**Resolution**: User decided to keep Story 7.2-3 as a separate story but redefine scope to "modify definition files only" (no migration scripts needed for greenfield scenario).

### Design Rationale

| 原设计 | 新设计 | 理由 |
|--------|--------|------|
| 迁移脚本中 `ALTER TABLE RENAME COLUMN` | 仅修改定义文件 | 从0创建数据库场景无需重命名操作 |

### Architecture Compliance

**Single Source of Truth**: Domain Registry definitions drive DDL generation via `ddl_generator`.

**KISS Principle**: Simple 4-file change, no code logic modification.

### Dependencies

**Blocks**: Story 7.2-2 (New Migration Structure)

**Blocked By**: Story 7.2-1 (Migration Backup and Archive) - **COMPLETED**

## Dev Agent Record

### Agent Model Used

claude-opus-4-5-20251101

### Completion Notes List

1. Modified `definitions/annuity_plans.py`: `primary_key="annuity_plans_id"` → `"id"`
2. Modified `definitions/portfolio_plans.py`: `primary_key="portfolio_plans_id"` → `"id"`
3. Modified `scripts/create_table/ddl/annuity_plans.sql`: Column + NOTICE updated
4. Modified `scripts/create_table/ddl/portfolio_plans.sql`: Column + NOTICE updated
5. Verified `ddl_generator.generate_create_table_sql("annuity_plans")` outputs `"id"` PRIMARY KEY

**Implementation Date:** 2025-12-28

### File List

**Modified**:
- `src/work_data_hub/infrastructure/schema/definitions/annuity_plans.py`
- `src/work_data_hub/infrastructure/schema/definitions/portfolio_plans.py`
- `scripts/create_table/ddl/annuity_plans.sql`
- `scripts/create_table/ddl/portfolio_plans.sql`

## Change Log

**2025-12-28** - Story 7.2-3 Implementation Complete:
- Unified primary key naming to `id` across all 4 files
- Verified ddl_generator output
- Story status set to done
