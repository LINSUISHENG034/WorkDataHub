# Validation Report

**Document:** docs/sprint-artifacts/stories/6.2-5-hybrid-reference-service-integration.md  
**Checklist:** .bmad/bmm/workflows/4-implementation/create-story/checklist.md  
**Date:** 2025-12-12 23:02:58

## Summary
- Overall: 2/8 passed (25%)
- Critical Issues: 0

## Section Results

### Story Context & Architecture
- ✓ Epic/dependency coverage and boundaries are explicit, including upstream/downstream stories and reuse guardrails (lines 0015-0024, 0578-0583).
- ✓ AD-011 alignment and two-layer model are referenced with clear integration scope (lines 0024, 0129-0155).

### Design & Contracts
- ⚠ API contract consistency: Summary/AC specify `ensure_references(domain, df, conn)` (lines 0009, 0036-0040) but technical guidance and pipeline integration require `fk_configs` argument and threshold config (lines 0248-0273, 0443-0465); output fields vary (`HybridResult` vs. line 0039 list). Define single authoritative signature, required inputs (fk_configs, adapters, thresholds), and response schema.
- ⚠ Pre-load/backfill orchestration detail: High-level flow exists (lines 0041-0059, 0108-0112) but lacks per-table gating (e.g., skip pre-load for config-only tables), partial failure handling (some tables pre-loaded, others degraded), and how degradation reason surfaces to callers/metrics. Add sequence, decision points, and error propagation rules.
- ⚠ Metrics and alerting: Coverage metrics and ratio are named (lines 0051-0055, 0468-0479) but missing persistence/logging targets, per-table vs. global thresholds, and alert channels/severity. Specify metric sinks (logger/event/DB), threshold config key, and warning/alert behaviors.
- ⚠ Pipeline integration and wiring: Tasks mention Dagster op and config loader (lines 0114-0118, 0443-0465, 0498-0500) but do not define how fk configs and sync adapters are injected, dependency ordering with existing ops, or retries/transactions. Document wiring steps, required resources, and failure hooks.

### Quality & Tests
- ⚠ Test coverage specificity: Test types listed (lines 0080-0090, 0514-0537) but lack fixtures for critical scenarios: repeated runs/idempotency, null/duplicate FK values, partial pre-load failure, mixed-domain configs, and performance envelope (10K rows) with assertions. Add explicit cases and data sets.
- ⚠ Data quality/observability: Auto-derived ratio warning noted (lines 0052-0055) but story omits how to surface review queues/export hooks (ties to Story 6.2.6) and how to reset `_needs_review` when authoritative data arrives. Add governance path and observability handoff notes.

## Failed Items
- None.

## Partial Items
- API contract consistency
- Pre-load/backfill orchestration detail
- Metrics and alerting
- Pipeline integration and wiring
- Test coverage specificity
- Data quality/observability

## Recommendations
1. Must Fix: Lock the public API signature (inputs/outputs), define degradation handling contract, and specify integration wiring (config loader, adapters, retries).
2. Should Improve: Clarify metric emission/alerting (threshold keys, sinks) and add concrete test fixtures covering idempotency, partial failures, and performance baseline.
3. Consider: Add governance hooks for `_needs_review` lifecycle and review exports to align with Story 6.2.6 observability.
